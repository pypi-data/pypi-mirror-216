(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{38:function(t,e,n){},45:function(t,e,n){"use strict";n.r(e);var a=n(6),o=n.n(a),i=n(28),c=n.n(i),s=n(5),r=n(4),d=n(7),l=n(0),u=n(1),h=n(2),b=n(3),v=n(11),j=n(10),m=n(26),f=(n(38),n(32)),g=n(12),p=function(t){var e=t.children,n=t.geometry,a=t.style;return Object(g.jsx)("div",{style:Object(j.a)(Object(j.a)({},a),{},{position:"absolute",left:"".concat(n.x,"%"),top:"".concat(n.y,"%"),height:"".concat(n.height,"%"),width:"".concat(n.width,"%")}),children:e})};function O(t){var e=t.annotation,n=e.geometry;return Object(g.jsx)("div",{style:{background:"black",color:"white",padding:10,position:"absolute",fontSize:12,left:"".concat(n.x,"%"),top:"".concat(n.y+n.height,"%")},children:e.data&&e.data.text},e.data.id)}var x=function(t){var e=t.annotations,n=t.labels,o=Object(a.useState)({}),i=Object(v.a)(o,2),c=i[0],s=i[1];return Object(a.useEffect)((function(){var t={};n.forEach((function(e){t[e]=0})),e.forEach((function(e){var n=e.data.text,a=t[n]?t[n]+1:1;t[n]=a})),s(t),console.log({tempData:t})}),[e]),Object(g.jsx)(g.Fragment,{children:Object(g.jsx)("div",{className:"dataHolder",children:Object.keys(c).map((function(t){return Object(g.jsxs)("div",{className:"dataItem",children:[Object(g.jsx)("div",{className:"dataItemLabel",children:t}),Object(g.jsx)("div",{className:"dataItemValue",children:c[t]})]},t)}))})})},y=function(t){Object(h.a)(n,t);var e=Object(b.a)(n);function n(t){var a,i;return Object(l.a)(this,n),(i=e.call(this,t)).canvasRef=o.a.createRef(),i.moveDiv=function(t){i.setState({coords:{x:t.clientX,y:t.clientY}})},i.onMouseMove=function(t){i.setState({showDiv:!0}),window.addEventListener("mousemove",i.moveDiv)},i.onMouseOut=function(t){i.setState({showDiv:!1}),window.removeEventListener("mousemove",i.moveDiv)},i.renderImageToCanvas=function(){return new Promise((function(t){var e=i.canvasRef.current,n=e.getContext("2d"),a=new Image;a.onload=function(){e.width=a.width,e.height=a.height,n.drawImage(a,0,0,a.width,a.height),i.state.annotations.forEach((function(t){var e=t.geometry,o=t.data,i=e.x,c=e.y,s=e.width,r=e.height,d=o.text,l=i/100*a.width,u=c/100*a.height,h=s/100*a.width,b=r/100*a.height;n.beginPath(),n.rect(l,u,h,b),n.lineWidth=3,n.strokeStyle="red",n.fillStyle="red",n.stroke(),n.font="40px Arial",n.fillText(d,l,u>15?u-5:u+15)})),t()},a.src="data:image/jpeg;base64,"+i.props.image}))},i.onChange=function(t){i.setState({annotation:t})},i.onSubmit=function(t){var e=t.geometry,n=t.data;i.setState({annotation:{},annotations:i.state.annotations.concat({geometry:e,data:Object(j.a)(Object(j.a)({},n),{},{id:Math.random()})})})},i.onChangeType=function(t){i.setState({annotation:{},type:t.currentTarget.innerHTML})},i.deleteAnnotation=function(t){i.setState({annotations:i.state.annotations.filter((function(e){return e.data.id!==t}))})},i.downloadImage=Object(d.a)(Object(r.a)().mark((function t(){var e,n,a;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.renderImageToCanvas();case 2:n=null===(e=i.canvasRef.current)||void 0===e?void 0:e.toDataURL(),(a=document.createElement("a")).href=n,a.download="image.png",a.click();case 7:case"end":return t.stop()}}),t)}))),i.state={annotations:Object(s.a)(null===(a=i.props)||void 0===a?void 0:a.detectedAnotations),annotation:{},showDiv:!1,coords:{x:0,y:0}},i}return Object(u.a)(n,[{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.moveDiv)}},{key:"render",value:function(){var t=this,e="data:image/jpeg;base64,"+this.props.image;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"hoverDiv",onMouseMove:this.onMouseMove,onMouseOut:this.onMouseOut,children:[Object(g.jsx)(f.a,{src:e,alt:"pcb",annotations:this.state.annotations,type:this.state.type,value:this.state.annotation,onChange:this.onChange,onSubmit:this.onSubmit,renderEditor:function(e){return function(t,e){var n=t.annotation.geometry;return n?Object(g.jsxs)("div",{className:"holder",style:{background:"rgba(0, 0, 0, 0.15)",left:"".concat(n.x>80?75:n.x,"%"),top:"".concat(n.y>85?85:n.y,"%")},children:[Object(g.jsxs)("select",{className:"selectItem",onChange:function(e){t.onChange(Object(j.a)(Object(j.a)({},t.annotation),{},{data:Object(j.a)(Object(j.a)({},t.annotation.data),{},{text:e.target.value})}))},children:[Object(g.jsx)("option",{value:"",children:"Select..."}),e.map((function(t){return Object(g.jsx)("option",{value:t,children:t},t)}))]}),Object(g.jsx)("button",{className:"addLabelButton",onClick:t.onSubmit,children:"Add"})]}):null}(e,t.props.labels)},renderContent:O,renderHighlight:function(e){return function(t){var e=t.annotation,n=t.active,a=t.deleteAnnotation,o=e.geometry;return o?Object(g.jsx)(p,{geometry:o,style:{border:"solid 1px ".concat(n?"#3e8e41":k())},children:n&&Object(g.jsx)("button",{className:"deleteAnnotationButton",onClick:function(){console.log("delete"),a(e.data.id)},children:"X"})},e.data.id):null}({annotation:e.annotation,active:e.active,deleteAnnotation:t.deleteAnnotation})}}),this.state.showDiv&&Object(g.jsx)("div",{className:"hover-info",style:{top:"".concat(this.state.coords.y+30,"px"),left:"".concat(this.state.coords.x+30,"px")},children:Object(g.jsx)(x,{labels:this.props.labels,annotations:this.state.annotations})})]}),Object(g.jsx)("button",{className:"downloadButton",onClick:this.downloadImage,children:"Download"}),Object(g.jsx)("canvas",{ref:this.canvasRef,style:{display:"none"}})]})}}]),n}(a.Component),w=function(t){Object(h.a)(n,t);var e=Object(b.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var t=this.props.args,e=t.image,n=t.labels,a=t.detectedAnotations;return Object(g.jsx)(y,{image:e,labels:n,detectedAnotations:a})}}]),n}(m.a),S=Object(m.b)(w);function k(){for(var t="#",e=0;e<6;e++){t+=Math.floor(16*Math.random()).toString(16)}return t}c.a.render(Object(g.jsx)(o.a.StrictMode,{children:Object(g.jsx)(S,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.209bf5ec.chunk.js.map