{% macro emit_boolean(value) %}
    {% if value %}<span class="badge bg-success">yes</span>{% else %}<span class="badge bg-danger">no</span>{% endif %}
{% endmacro %}

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="icon" type="image/x-icon" href="favicon.ico" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <title>About</title>
    </head>
    <body>
        <div class="container">
            <div>
                <h2>Versions</h2>

                <div class="row">
                    <b class="col-4">Package version:</b>
                    <div class="col-8">{{ __VERSION__ }}</div>
                </div>

                <div class="row">
                    <b class="col-4">Image URL:</b>
                    <div class="col-8">{{ os.getenv('ARTEMIS_IMAGE_URL', 'unknown') }}</div>
                </div>

                <div class="row">
                    <b class="col-4">Image digest:</b>
                    <div class="col-8">{{ os.getenv('ARTEMIS_IMAGE_DIGEST', 'unknown') }}</div>
                </div>

                <div class="row">
                    <b class="col-4">Supported API versions:</b>
                    <div class="col-8">
                        {% for version, _, _ in API_MILESTONES %}
                        <span class="badge bg-light text-dark font-monospace">{{ version }}</span>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div>
                <h2>Deployment</h2>

                <div class="row">
                    <b class="col-4">Deployment name:</b>
                    <div class="col-8">{{ KNOB_DEPLOYMENT.value }}</div>
                </div>

                <div class="row">
                    <b class="col-4">Deployment environment:</b>
                    <div class="col-8">{{ KNOB_DEPLOYMENT_ENVIRONMENT.value }}</div>
                </div>
            </div>

            <hr class="hr" />

            <div>
                <h2>Pools</h2>

{% for pool in POOLS | sort(attribute='poolname') %}
                <div>
                    <div class="row">
                        <div class="col-11 offset-1"><h4>{{ pool.poolname }}</h4></div>
                    </div>

                    <div class="row">
                        <div class="col-4 offset-1"><b>Driver</b></div>
                        <div class="col-7"><code>{{ pool.drivername }}</code></div>
                    </div>

                    <div class="row">
                        <div class="col-4 offset-1"><b>Use only when addressed?</b></div>
                        <div class="col-7">{{ emit_boolean(pool.pool_config.get('use-only-when-addressed')) }}</div>
                    </div>

                    <div class="row">
                        <div class="col-4 offset-1"><b>Guest tags</b></div>
                        <div class="col-7"><span class="badge bg-info text-dark">TODO</span></div>
                    </div>

                    <div class="row">
                        <div class="col-4 offset-1"><b>SSH options</b></div>
                        <div class="col-7"><code>{{ pool.ssh_options | join(" ") }}</code></div>
                    </div>

                    {% if pool.drivername == 'aws' %}
                        <div class="row">
                            <div class="col-4 offset-1"><b>Image owners</b></div>
                            <div class="col-7">
                                {% for owner in pool._image_owners %}
                                    <span class="badge bg-light text-dark font-monospace">{{ owner }}</span>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-4 offset-1"><b>Image name filters</b></div>
                            <div class="col-7">
                                {% for pattern in pool.pool_config.get('image-name-filters', []) %}
                                    <span class="badge bg-light text-dark font-monospace">{{ pattern }}</span>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}

                    <div class="row">
                        <div class="col-11 offset-1"><hr class="hr" /></div>
                    </div>
                </div>
{% endfor %}

            </div>


        </div>
    </body>
</html>
