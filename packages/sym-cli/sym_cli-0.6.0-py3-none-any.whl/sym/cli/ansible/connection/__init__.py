import base64

# cat sym_aws_ssm.py | openssl base64
sym_aws_ssm_source = base64.b64decode(
    """IyBJZ25vcmUgYmxhY2sgZm9ybWF0dGluZyBpbiB0aGlzIGZpbGUgdG8gZW5zdXJl
IGJhY2t3YXJkCiMgY29tcGF0aWJpbGl0eSB3aXRoIHB5dGhvbiAyLjcKIyBmbXQ6
IG9mZgoKZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhYnNvbHV0ZV9pbXBvcnQsIGRp
dmlzaW9uLCBwcmludF9mdW5jdGlvbgoKX19tZXRhY2xhc3NfXyA9IHR5cGUKCkRP
Q1VNRU5UQVRJT04gPSAiIiIKYXV0aG9yOgotIFlhc3lmIE1vaGFtZWRhbGkgPHlh
c3lmQHN5bW9wcy5pbz4KLSBSaWNrIER1Y290dCA8cmlja0BzeW1vcHMuaW8+CmNv
bm5lY3Rpb246IHN5bV9hd3Nfc3NtCnNob3J0X2Rlc2NyaXB0aW9uOiBVc2UgU1NN
IFNlbmRDb21tYW5kIGFzIGFuIEFuc2libGUgQ29ubmVjdGlvbgpkZXNjcmlwdGlv
bjoKLSBVc2UgU1NNIFNlbmRDb21tYW5kIGFzIGFuIEFuc2libGUgQ29ubmVjdGlv
bi4gSW5zcGlyZWQgaGVhdmlseSBieSBjb21tdW5pdHkuYXdzLmF3c19zc20uCnJl
cXVpcmVtZW50czoKLSBzZXNzaW9uLW1hbmFnZXItcGx1Z2luIGlzIG9uIHlvdXIg
UEFUSApvcHRpb25zOgogIHJlZ2lvbjoKICAgIGRlc2NyaXB0aW9uOiBUaGUgcmVn
aW9uIHRvIHVzZSBmb3IgYWxsIGJvdG8gY29tbWFuZHMKICAgIHZhcnM6CiAgICAt
IG5hbWU6IGFuc2libGVfYXdzX3NzbV9yZWdpb24KICAgIGRlZmF1bHQ6ICd1cy1l
YXN0LTEnCiAgYnVja2V0OgogICAgZGVzY3JpcHRpb246IFRoZSBuYW1lIG9mIHRo
ZSBTMyBidWNrZXQgdXNlZCBmb3IgZmlsZSB0cmFuc2ZlcnMuCiAgICB2YXJzOgog
ICAgLSBuYW1lOiBhbnNpYmxlX2F3c19zc21fYnVja2V0CiAgcHJvZmlsZToKICAg
IGRlc2NyaXB0aW9uOiBUaGUgQVdTIHByb2ZpbGUgdG8gdXNlCiAgICB2YXJzOgog
ICAgLSBuYW1lOiBhbnNpYmxlX2F3c19zc21fcHJvZmlsZQogICAgICBkZWZhdWx0
OiAnc3ltLWFuc2libGUnCiAgcmV0cmllczoKICAgIGRlc2NyaXB0aW9uOiBOdW1i
ZXIgb2YgYXR0ZW1wdHMgdG8gY29ubmVjdC4KICAgIGRlZmF1bHQ6IDMKICAgIHR5
cGU6IGludGVnZXIKICAgIHZhcnM6CiAgICAtIG5hbWU6IGFuc2libGVfYXdzX3Nz
bV9yZXRyaWVzCiAgc3NtX3RpbWVvdXQ6CiAgICBkZXNjcmlwdGlvbjogU1NNIGNv
bm5lY3Rpb24gdGltZW91dCAoaW4gc2Vjb25kcykKICAgIGRlZmF1bHQ6IDEyMAog
ICAgdHlwZTogaW50ZWdlcgogICAgdmFyczoKICAgIC0gbmFtZTogYW5zaWJsZV9h
d3Nfc3NtX3RpbWVvdXQKICBob3N0X2NvbW1hbmQ6CiAgICBkZXNjcmlwdGlvbjog
SG9zdC10by1JbnN0YW5jZSBjb21tYW5kCiAgICB2YXJzOgogICAgLSBuYW1lOiBh
bnNpYmxlX2F3c19zc21faG9zdF9jbWQKIiIiCgppbXBvcnQganNvbgppbXBvcnQg
b3MKaW1wb3J0IHB0eQppbXBvcnQgc2VsZWN0CmltcG9ydCBzaGxleAppbXBvcnQg
c3VicHJvY2VzcwppbXBvcnQgdGltZQpmcm9tIGZ1bmN0b29scyBpbXBvcnQgd3Jh
cHMKCmltcG9ydCBib3RvMwpmcm9tIGFuc2libGUuZXJyb3JzIGltcG9ydCBBbnNp
YmxlQ29ubmVjdGlvbkZhaWx1cmUsIEFuc2libGVFcnJvciwgQW5zaWJsZUZpbGVO
b3RGb3VuZApmcm9tIGFuc2libGUubW9kdWxlX3V0aWxzLl90ZXh0IGltcG9ydCB0
b19ieXRlcywgdG9fbmF0aXZlLCB0b190ZXh0CmZyb20gYW5zaWJsZS5tb2R1bGVf
dXRpbHMuc2l4Lm1vdmVzIGltcG9ydCB4cmFuZ2UKZnJvbSBhbnNpYmxlLnBsdWdp
bnMuY29ubmVjdGlvbiBpbXBvcnQgQ29ubmVjdGlvbkJhc2UKZnJvbSBhbnNpYmxl
LnV0aWxzLmRpc3BsYXkgaW1wb3J0IERpc3BsYXkKClVSTF9UVEwgPSAzNjAwCkNI
VU5LX1NJWkUgPSAxMDI0Ck1BWF9ERUxBWSA9IDMwClNUQVJUX0NPTU1BTkQgPSAi
U1lNX0NPTU1BTkRfU1RBUlQiCkVORF9DT01NQU5EID0gIlNZTV9DT01NQU5EX0VO
RCIKCmRpc3BsYXkgPSBEaXNwbGF5KCkKCgpkZWYgc3NtX3JldHJ5KGZ1bmMpOgog
ICAgQHdyYXBzKGZ1bmMpCiAgICBkZWYgd3JhcHBlZChzZWxmLCAqYXJncywgKipr
d2FyZ3MpOgogICAgICAgIHJldHJpZXMgPSBpbnQoc2VsZi5nZXRfb3B0aW9uKCJy
ZXRyaWVzIikpCiAgICAgICAgY21kID0gYXJnc1swXQoKICAgICAgICBmb3IgYXR0
ZW1wdCBpbiB4cmFuZ2UocmV0cmllcyk6CiAgICAgICAgICAgIHRyeToKICAgICAg
ICAgICAgICAgIHJlc3BvbnNlID0gZnVuYyhzZWxmLCAqYXJncywgKiprd2FyZ3Mp
CiAgICAgICAgICAgICAgICBkaXNwbGF5LnZ2dihyZXNwb25zZSwgaG9zdD1zZWxm
Lmhvc3QpCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UKICAgICAgICAg
ICAgZXhjZXB0IHNlbGYuX3NzbV9jbGllbnQuZXhjZXB0aW9ucy5UYXJnZXROb3RD
b25uZWN0ZWQgYXMgZToKICAgICAgICAgICAgICAgIHJhaXNlIEFuc2libGVDb25u
ZWN0aW9uRmFpbHVyZSgKICAgICAgICAgICAgICAgICAgICAiSW5zdGFuY2UgJXMg
KCVzKSBtdXN0IGJlIG1hbmFnZWQgYnkgU2Vzc2lvbiBNYW5hZ2VyLiBJcyBTU00g
QWdlbnQgaW5zdGFsbGVkIGFuZCBhY3RpdmU/IgogICAgICAgICAgICAgICAgICAg
ICUgKHNlbGYuaW5zdGFuY2VfaWQsIHNlbGYuaG9zdCksCiAgICAgICAgICAgICAg
ICAgICAgb3JpZ19leGM9ZSwKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAg
ZXhjZXB0IChBbnNpYmxlQ29ubmVjdGlvbkZhaWx1cmUsIEV4Y2VwdGlvbikgYXMg
ZToKICAgICAgICAgICAgICAgIGlmICJSZXF1ZXN0RXhwaXJlZCIgaW4gc3RyKGUp
OgogICAgICAgICAgICAgICAgICAgIHJhaXNlIEFuc2libGVDb25uZWN0aW9uRmFp
bHVyZSgKICAgICAgICAgICAgICAgICAgICAgICAgIllvdXIgQVdTIGNyZWRlbnRp
YWxzIGhhdmUgZXhwaXJlZC4gUGxlYXNlIHJlZnJlc2ggdGhlbSBhbmQgdHJ5IGFn
YWluLiIsCiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdfZXhjPWUsCiAgICAg
ICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgIGlmIGF0dGVtcHQgPT0g
cmV0cmllcyAtIDE6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgQW5zaWJsZUNv
bm5lY3Rpb25GYWlsdXJlKGUpCgogICAgICAgICAgICAgICAgZGVsYXkgPSBtaW4o
KDIgKiogYXR0ZW1wdCkgLSAxLCBNQVhfREVMQVkpCgogICAgICAgICAgICAgICAg
aWYgaXNpbnN0YW5jZShlLCBBbnNpYmxlQ29ubmVjdGlvbkZhaWx1cmUpOgogICAg
ICAgICAgICAgICAgICAgIG1zZyA9ICJzc21fcmV0cnk6IGF0dGVtcHQ6ICVkLCBj
bWQgKCVzKSwgcGF1c2luZyBmb3IgJWQgc2Vjb25kcyIgJSAoCiAgICAgICAgICAg
ICAgICAgICAgICAgIGF0dGVtcHQsCiAgICAgICAgICAgICAgICAgICAgICAgIGNt
ZCwKICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXksCiAgICAgICAgICAgICAg
ICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAg
ICBtc2cgPSAoCiAgICAgICAgICAgICAgICAgICAgICAgICJzc21fcmV0cnk6IGF0
dGVtcHQ6ICVkLCBjYXVnaHQgZXhjZXB0aW9uKCVzKSBmcm9tIGNtZCAoJXMpLCBw
YXVzaW5nIGZvciAlZCBzZWNvbmRzIgogICAgICAgICAgICAgICAgICAgICAgICAl
IChhdHRlbXB0LCBlLCBjbWQsIGRlbGF5KQogICAgICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgIGRpc3BsYXkudnYobXNnLCBob3N0PXNlbGYuaG9zdCkK
CiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKGRlbGF5KQogICAgICAgICAgICAg
ICAgc2VsZi5jbG9zZSgpCgogICAgcmV0dXJuIHdyYXBwZWQKCgpkZWYgY2h1bmtz
KGxzdCwgbik6CiAgICAiIiJZaWVsZCBzdWNjZXNzaXZlIG4tc2l6ZWQgY2h1bmtz
IGZyb20gbHN0LiIiIgogICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKGxzdCksIG4p
OgogICAgICAgIHlpZWxkIGxzdFtpIDogaSArIG5dCgoKY2xhc3MgUG9sbGVyOgog
ICAgZGVmIF9faW5pdF9fKHNlbGYsIGZkKToKICAgICAgICBzZWxmLmZkID0gZmQK
CiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBjcmVhdGUoY2xzLCBmZCk6CiAgICAg
ICAgaWYgaGFzYXR0cihzZWxlY3QsICJwb2xsIik6CiAgICAgICAgICAgIHJldHVy
biBQb2xsUG9sbGVyKGZkKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVy
biBLUXVldWVQb2xsZXIoZmQpCgogICAgZGVmIHBvbGwoc2VsZiwgdGltZW91dCk6
CiAgICAgICAgcmV0dXJuIHNlbGYuX3BvbGwodGltZW91dD10aW1lb3V0KQoKICAg
IGRlZiBfcG9sbChzZWxmLCB0aW1lb3V0KToKICAgICAgICByYWlzZSBOb3RJbXBs
ZW1lbnRlZEVycm9yCgoKY2xhc3MgS1F1ZXVlUG9sbGVyKFBvbGxlcik6CiAgICBk
ZWYgX19pbml0X18oc2VsZiwgZmQpOgogICAgICAgIHN1cGVyKEtRdWV1ZVBvbGxl
ciwgc2VsZikuX19pbml0X18oZmQpCiAgICAgICAgc2VsZi5rcSA9IHNlbGVjdC5r
cXVldWUoKQogICAgICAgIHNlbGYua2V2dHMgPSBbc2VsZWN0LmtldmVudChzZWxm
LmZkKV0KCiAgICBkZWYgX3BvbGwoc2VsZiwgdGltZW91dCk6CiAgICAgICAgcmV0
dXJuIGJvb2woc2VsZi5rcS5jb250cm9sKHNlbGYua2V2dHMsIDEsIHRpbWVvdXQp
KQoKCmNsYXNzIFBvbGxQb2xsZXIoUG9sbGVyKToKICAgIGRlZiBfX2luaXRfXyhz
ZWxmLCBmZCk6CiAgICAgICAgc3VwZXIoUG9sbFBvbGxlciwgc2VsZikuX19pbml0
X18oZmQpCiAgICAgICAgc2VsZi5wb2xsZXIgPSBzZWxlY3QucG9sbCgpCiAgICAg
ICAgc2VsZi5wb2xsZXIucmVnaXN0ZXIoc2VsZi5mZCwgc2VsZWN0LlBPTExJTikK
CiAgICBkZWYgX3BvbGwoc2VsZiwgdGltZW91dCk6CiAgICAgICAgcmV0dXJuIGJv
b2woc2VsZi5wb2xsZXIucG9sbCh0aW1lb3V0KSkKCgpjbGFzcyBDb25uZWN0aW9u
KENvbm5lY3Rpb25CYXNlKToKICAgICIiIiBBV1MgU1NNIGJhc2VkIGNvbm5lY3Rp
b25zICIiIgoKICAgIHRyYW5zcG9ydCA9ICJzeW1fYXdzX3NzbSIKICAgIGFsbG93
X2V4ZWN1dGFibGUgPSBGYWxzZQogICAgYWxsb3dfZXh0cmFzID0gVHJ1ZQogICAg
aGFzX3BpcGVsaW5pbmcgPSBGYWxzZQoKICAgIF9wcm9jZXNzID0gTm9uZQogICAg
X3Nlc3Npb25faWQgPSBOb25lCgogICAgX3N0ZG91dCA9IE5vbmUKICAgIF9wb2xs
X3N0ZG91dCA9IE5vbmUKICAgIF9wb2xsX3N0ZGVyciA9IE5vbmUKCiAgICBfc3Nt
X2NsaWVudCA9IE5vbmUKICAgIF9zM19jbGllbnQgPSBOb25lCgogICAgX3Rlcm1p
bmF0ZSA9IEZhbHNlCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3
YXJncyk6CiAgICAgICAgc3VwZXIoQ29ubmVjdGlvbiwgc2VsZikuX19pbml0X18o
KmFyZ3MsICoqa3dhcmdzKQogICAgICAgIHNlbGYuaG9zdCA9IHNlbGYuX3BsYXlf
Y29udGV4dC5yZW1vdGVfYWRkcgogICAgICAgIHNlbGYudXNlciA9IHNlbGYuX3Bs
YXlfY29udGV4dC5yZW1vdGVfdXNlcgoKICAgICAgICAjIEluIEFuc2libGUgMi41
LCBfbG9hZF9uYW1lIGhhcyBub3QgeWV0IGJlZW4gc2V0LAogICAgICAgICMgc28g
dGhlIGxvYWRpbmcgcmVzb3VyY2VzIHRoYXQgdXNlIGBzZWxmLmdldF9vcHRpb25g
IGZyb20KICAgICAgICAjIGluaXQgZmFpbC4gQXMgYSByZXN1bHQsIHdlIHNldCB0
aGVtIHRvIE5vbmUgaGVyZSBhbmQKICAgICAgICAjIGluaXRpYWxpemUgdGhlbSB3
aGVuIHRoZXkncmUgbmVlZGVkLgogICAgICAgIHNlbGYuX3NzbV9jbGllbnQgPSBO
b25lCiAgICAgICAgc2VsZi5fczNfY2xpZW50ID0gTm9uZQoKICAgIGRlZiBfY29u
bmVjdChzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5fc2Vzc2lvbl9pZDoKICAg
ICAgICAgICAgc2VsZi5zdGFydF9zc21fc2Vzc2lvbigpCiAgICAgICAgcmV0dXJu
IHNlbGYKCiAgICBkZWYgX2dldF9pbnN0YW5jZV9tZXRhKHNlbGYpOgogICAgICAg
IGNtZCA9IHNlbGYuZ2V0X29wdGlvbigiaG9zdF9jb21tYW5kIikucmVwbGFjZSgi
JEhPU1QiLCBzZWxmLmhvc3QpCiAgICAgICAgcmV0dXJuIGpzb24ubG9hZHModG9f
dGV4dChzdWJwcm9jZXNzLmNoZWNrX291dHB1dChzaGxleC5zcGxpdChjbWQpKS5z
dHJpcCgpKSkKCiAgICBkZWYgX3N0YXJ0X3Byb2Nlc3Moc2VsZiwgY21kKToKICAg
ICAgICBkaXNwbGF5LnZ2dnYodSJTU00gQ09NTUFORDogezB9Ii5mb3JtYXQodG9f
dGV4dChjbWQpKSwgaG9zdD1zZWxmLmhvc3QpCgogICAgICAgIHN0ZG91dF9yLCBz
dGRvdXRfdyA9IHB0eS5vcGVucHR5KCkKICAgICAgICBzZWxmLl9wcm9jZXNzID0g
c3VicHJvY2Vzcy5Qb3BlbigKICAgICAgICAgICAgY21kLAogICAgICAgICAgICBz
dGRpbj1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgIHN0ZG91dD1zdGRvdXRf
dywKICAgICAgICAgICAgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAg
ICAgY2xvc2VfZmRzPVRydWUsCiAgICAgICAgICAgIGJ1ZnNpemU9MCwKICAgICAg
ICApCiAgICAgICAgb3MuY2xvc2Uoc3Rkb3V0X3cpCgogICAgICAgIHNlbGYuX3N0
ZG91dCA9IG9zLmZkb3BlbihzdGRvdXRfciwgInJiIiwgMCkKCiAgICAgICAgc2Vs
Zi5fcG9sbF9zdGRvdXQgPSBQb2xsZXIuY3JlYXRlKHNlbGYuX3N0ZG91dCkKICAg
ICAgICBzZWxmLl9wb2xsX3N0ZGVyciA9IFBvbGxlci5jcmVhdGUoc2VsZi5fcHJv
Y2Vzcy5zdGRlcnIpCgogICAgZGVmIF9wcmVwYXJlX3Rlcm1pbmFsKHNlbGYpOgog
ICAgICAgICMgRGlzYWJsZSBjb21tYW5kIGVjaG8gYW5kIHByb21wdAogICAgICAg
IHNlbGYuX3Byb2Nlc3Muc3RkaW4ud3JpdGUodG9fYnl0ZXMoInN0dHkgLWVjaG9c
biIgKyAiUFMxPScnXG4iKSkKCiAgICBkZWYgc3RhcnRfc3NtX3Nlc3Npb24oc2Vs
Zik6CiAgICAgICAgaW5zdGFuY2VfbWV0YSA9IHNlbGYuX2dldF9pbnN0YW5jZV9t
ZXRhKCkKICAgICAgICBzZWxmLmluc3RhbmNlX2lkID0gaW5zdGFuY2VfbWV0YVsi
aW5zdGFuY2UiXQoKICAgICAgICBzZWxmLl9zM19jbGllbnQgPSBzZWxmLl9nZXRf
Ym90b19jbGllbnQoInMzIikKICAgICAgICBzZWxmLl9zc21fY2xpZW50ID0gc2Vs
Zi5fZ2V0X2JvdG9fY2xpZW50KCJzc20iLCByZWdpb249aW5zdGFuY2VfbWV0YVsi
cmVnaW9uIl0pCgogICAgICAgIGRpc3BsYXkudnZ2KAogICAgICAgICAgICB1IkVT
VEFCTElTSCBTU00gQ09OTkVDVElPTiBUTzogezB9Ii5mb3JtYXQoc2VsZi5pbnN0
YW5jZV9pZCksCiAgICAgICAgICAgIGhvc3Q9c2VsZi5ob3N0LAogICAgICAgICkK
CiAgICAgICAgcmVzcG9uc2UgPSBzZWxmLl9zc21fY2xpZW50LnN0YXJ0X3Nlc3Np
b24oCiAgICAgICAgICAgIFRhcmdldD1zZWxmLmluc3RhbmNlX2lkLAogICAgICAg
ICAgICBEb2N1bWVudE5hbWU9IkFXUy1TdGFydEludGVyYWN0aXZlQ29tbWFuZCIs
CiAgICAgICAgICAgIFBhcmFtZXRlcnM9eyJjb21tYW5kIjogWyJzdWRvIHN1IC1s
IHswfSIuZm9ybWF0KHNlbGYudXNlcildfSwKICAgICAgICApCiAgICAgICAgc2Vs
Zi5fc2Vzc2lvbl9pZCA9IHJlc3BvbnNlWyJTZXNzaW9uSWQiXQogICAgICAgIGRp
c3BsYXkudnZ2KHUiU1NNIENPTk5FQ1RJT04gSUQ6IHswfSIuZm9ybWF0KHNlbGYu
X3Nlc3Npb25faWQpLCBob3N0PXNlbGYuaG9zdCkKCiAgICAgICAgY21kID0gWwog
ICAgICAgICAgICAic2Vzc2lvbi1tYW5hZ2VyLXBsdWdpbiIsCiAgICAgICAgICAg
IGpzb24uZHVtcHMocmVzcG9uc2UpLAogICAgICAgICAgICBzZWxmLmdldF9vcHRp
b24oInJlZ2lvbiIpLAogICAgICAgICAgICAiU3RhcnRTZXNzaW9uIiwKICAgICAg
ICAgICAgc2VsZi5nZXRfb3B0aW9uKCJwcm9maWxlIiksCiAgICAgICAgICAgIGpz
b24uZHVtcHMoeyJUYXJnZXQiOiBzZWxmLmluc3RhbmNlX2lkfSksCiAgICAgICAg
ICAgIHNlbGYuX3NzbV9jbGllbnQubWV0YS5lbmRwb2ludF91cmwsCiAgICAgICAg
XQoKICAgICAgICBzZWxmLl9zdGFydF9wcm9jZXNzKGNtZCkKICAgICAgICBzZWxm
Ll9wcmVwYXJlX3Rlcm1pbmFsKCkKCiAgICBkZWYgX3dyYXBfY29tbWFuZChzZWxm
LCBjbWQpOgogICAgICAgIHJldHVybiAiZWNobyB7MX07IHswfTsgZWNobyB7Mn0g
JD9cbiIuZm9ybWF0KGNtZCwgU1RBUlRfQ09NTUFORCwgRU5EX0NPTU1BTkQpCgog
ICAgZGVmIF9mbHVzaF9zdGRlcnIoc2VsZik6CiAgICAgICAgc3RkZXJyID0gIiIK
CiAgICAgICAgd2hpbGUgc2VsZi5fcHJvY2Vzcy5wb2xsKCkgaXMgTm9uZToKICAg
ICAgICAgICAgaWYgc2VsZi5fcG9sbF9zdGRlcnIucG9sbCgxKToKICAgICAgICAg
ICAgICAgIGxpbmUgPSBzZWxmLl9wcm9jZXNzLnN0ZGVyci5yZWFkbGluZSgpCiAg
ICAgICAgICAgICAgICBkaXNwbGF5LnZ2dnYodSJzdGRlcnIgbGluZTogezB9Ii5m
b3JtYXQodG9fdGV4dChsaW5lKSksIGhvc3Q9c2VsZi5ob3N0KQogICAgICAgICAg
ICAgICAgc3RkZXJyID0gc3RkZXJyICsgbGluZQogICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgcmV0dXJuIHN0ZGVycgoKICAg
IGRlZiBfZ2V0X3JldHVybmNvZGUoc2VsZiwgbGluZSk6CiAgICAgICAgcmV0dXJu
IGludChsaW5lLnNwbGl0KCIgIilbLTFdKQoKICAgIGRlZiBfcHJvY2Vzc19saW5l
KHNlbGYsIGxpbmUpOgogICAgICAgIHJldHVybiB0b190ZXh0KGxpbmUpLnJlcGxh
Y2UoIlxyXHJcbiIsICJcbiIpCgogICAgQHNzbV9yZXRyeQogICAgZGVmIGV4ZWNf
Y29tbWFuZChzZWxmLCBjbWQsIGluX2RhdGE9Tm9uZSwgc3Vkb2FibGU9VHJ1ZSk6
CiAgICAgICAgc3VwZXIoQ29ubmVjdGlvbiwgc2VsZikuZXhlY19jb21tYW5kKGNt
ZCwgaW5fZGF0YT1pbl9kYXRhLCBzdWRvYWJsZT1zdWRvYWJsZSkKCiAgICAgICAg
Y21kID0gc2VsZi5fd3JhcF9jb21tYW5kKGNtZCkKICAgICAgICBkaXNwbGF5LnZ2
dih1IkVYRUMgc2VuZDogezB9Ii5mb3JtYXQodG9fdGV4dChjbWQpKSwgaG9zdD1z
ZWxmLmhvc3QpCgogICAgICAgIHNlbGYuX2ZsdXNoX3N0ZGVycigpCgogICAgICAg
IGZvciBjaHVuayBpbiBjaHVua3MoY21kLCBDSFVOS19TSVpFKToKICAgICAgICAg
ICAgc2VsZi5fcHJvY2Vzcy5zdGRpbi53cml0ZSh0b19ieXRlcyhjaHVuaykpCgog
ICAgICAgIHN0YXJ0ZWQgPSBGYWxzZQogICAgICAgIHN0ZG91dCA9ICIiCgogICAg
ICAgIGZvciBlbGFwc2VkIGluIHJhbmdlKHNlbGYuZ2V0X29wdGlvbigic3NtX3Rp
bWVvdXQiKSk6CiAgICAgICAgICAgIGlmIHNlbGYuX3Byb2Nlc3MucG9sbCgpOgog
ICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgIGlmIGVsYXBzZWQgPT0g
c2VsZi5nZXRfb3B0aW9uKCJzc21fdGltZW91dCIpIC0gMToKICAgICAgICAgICAg
ICAgIHNlbGYuX3Rlcm1pbmF0ZSA9IFRydWUKICAgICAgICAgICAgICAgIGRpc3Bs
YXkudnZ2digKICAgICAgICAgICAgICAgICAgICB1IkVYRUMgdGltZW91dCBzdGRv
dXQ6IHswfSIuZm9ybWF0KHRvX3RleHQoc3Rkb3V0KSksCiAgICAgICAgICAgICAg
ICAgICAgaG9zdD1zZWxmLmhvc3QsCiAgICAgICAgICAgICAgICApCiAgICAgICAg
ICAgICAgICByYWlzZSBBbnNpYmxlQ29ubmVjdGlvbkZhaWx1cmUoCiAgICAgICAg
ICAgICAgICAgICAgIlNTTSBleGVjX2NvbW1hbmQgdGltZW91dCBvbiBob3N0OiB7
MH0iLmZvcm1hdChzZWxmLmluc3RhbmNlX2lkKQogICAgICAgICAgICAgICAgKQoK
ICAgICAgICAgICAgaWYgbm90IHNlbGYuX3BvbGxfc3Rkb3V0LnBvbGwoMTAwMCk6
CiAgICAgICAgICAgICAgICBkaXNwbGF5LnZ2dnYodSJFWEVDIGVsYXBzZWQ6IHsw
fSIuZm9ybWF0KGVsYXBzZWQpLCBob3N0PXNlbGYuaG9zdCkKICAgICAgICAgICAg
ICAgIGNvbnRpbnVlCgogICAgICAgICAgICBsaW5lID0gc2VsZi5fcHJvY2Vzc19s
aW5lKHNlbGYuX3N0ZG91dC5yZWFkbGluZSgpKQogICAgICAgICAgICBkaXNwbGF5
LnZ2dnYodSJFWEVDIHN0ZG91dCBsaW5lOiB7MH0iLmZvcm1hdChsaW5lKSwgaG9z
dD1zZWxmLmhvc3QpCgogICAgICAgICAgICBpZiBub3Qgc3RhcnRlZCBhbmQgU1RB
UlRfQ09NTUFORCBpbiBsaW5lOgogICAgICAgICAgICAgICAgZGlzcGxheS52dnZ2
KHUiRVhFQyBzdGFydCIsIGhvc3Q9c2VsZi5ob3N0KQogICAgICAgICAgICAgICAg
c3RhcnRlZCA9IFRydWUKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAg
ICAgICBpZiBub3Qgc3RhcnRlZDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgog
ICAgICAgICAgICBpZiBFTkRfQ09NTUFORCBpbiBsaW5lOgogICAgICAgICAgICAg
ICAgcmV0dXJuY29kZSA9IHNlbGYuX2dldF9yZXR1cm5jb2RlKGxpbmUpCiAgICAg
ICAgICAgICAgICBkaXNwbGF5LnZ2dnYodSJFWEVDIGVuZDogezB9Ii5mb3JtYXQo
bGluZSksIGhvc3Q9c2VsZi5ob3N0KQogICAgICAgICAgICAgICAgcmV0dXJuIChy
ZXR1cm5jb2RlLCBzdGRvdXQsIHNlbGYuX2ZsdXNoX3N0ZGVycigpKQoKICAgICAg
ICAgICAgc3Rkb3V0ID0gc3Rkb3V0ICsgbGluZQoKICAgICAgICByZXR1cm4gKHNl
bGYuX3Byb2Nlc3MucmV0dXJuY29kZSwgc3Rkb3V0LCBzZWxmLl9mbHVzaF9zdGRl
cnIoKSkKCiAgICBkZWYgX2dldF9ib3RvX2NsaWVudChzZWxmLCBzZXJ2aWNlLCBy
ZWdpb249Tm9uZSk6CiAgICAgICAgcmV0dXJuIGJvdG8zLlNlc3Npb24oCiAgICAg
ICAgICAgIHByb2ZpbGVfbmFtZT1zZWxmLmdldF9vcHRpb24oInByb2ZpbGUiKSwK
ICAgICAgICAgICAgcmVnaW9uX25hbWU9cmVnaW9uIG9yIHNlbGYuZ2V0X29wdGlv
bigicmVnaW9uIiksCiAgICAgICAgKS5jbGllbnQoc2VydmljZSkKCiAgICBkZWYg
X2dldF91cmwoc2VsZiwgYWN0aW9uLCBrZXksIGh0dHBfbWV0aG9kKToKICAgICAg
ICByZXR1cm4gc2VsZi5fczNfY2xpZW50LmdlbmVyYXRlX3ByZXNpZ25lZF91cmwo
CiAgICAgICAgICAgIGFjdGlvbiwKICAgICAgICAgICAgUGFyYW1zPXsiQnVja2V0
Ijogc2VsZi5nZXRfb3B0aW9uKCJidWNrZXQiKSwgIktleSI6IGtleX0sCiAgICAg
ICAgICAgIEV4cGlyZXNJbj1VUkxfVFRMLAogICAgICAgICAgICBIdHRwTWV0aG9k
PWh0dHBfbWV0aG9kLAogICAgICAgICkKCiAgICBAc3NtX3JldHJ5CiAgICBkZWYg
X2ZpbGVfdHJhbnNwb3J0X2NvbW1hbmQoc2VsZiwgaW5fcGF0aCwgb3V0X3BhdGgs
IHNzbV9hY3Rpb24pOgogICAgICAgIHBhdGggPSAiezB9L3sxfSIuZm9ybWF0KHNl
bGYuaW5zdGFuY2VfaWQsIG91dF9wYXRoKQoKICAgICAgICBpZiBzc21fYWN0aW9u
ID09ICJnZXQiOgogICAgICAgICAgICBjb21tYW5kID0gImN1cmwgLS1yZXF1ZXN0
IFBVVCAtLXVwbG9hZC1maWxlICd7MH0nICd7MX0nIi5mb3JtYXQoCiAgICAgICAg
ICAgICAgICBpbl9wYXRoLCBzZWxmLl9nZXRfdXJsKCJwdXRfb2JqZWN0IiwgcGF0
aCwgIlBVVCIpCiAgICAgICAgICAgICkKICAgICAgICAgICAgcmVzdWx0ID0gc2Vs
Zi5leGVjX2NvbW1hbmQoY29tbWFuZCwgaW5fZGF0YT1Ob25lLCBzdWRvYWJsZT1G
YWxzZSkKICAgICAgICAgICAgd2l0aCBvcGVuKHRvX2J5dGVzKG91dF9wYXRoKSwg
IndiIikgYXMgZjoKICAgICAgICAgICAgICAgIHNlbGYuX3MzX2NsaWVudC5kb3du
bG9hZF9maWxlb2JqKHNlbGYuZ2V0X29wdGlvbigiYnVja2V0IiksIHBhdGgsIGYp
CiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29tbWFuZCA9ICJjdXJsICd7MH0n
IC1vICd7MX0nIi5mb3JtYXQoCiAgICAgICAgICAgICAgICBzZWxmLl9nZXRfdXJs
KCJnZXRfb2JqZWN0IiwgcGF0aCwgIkdFVCIpLCBvdXRfcGF0aAogICAgICAgICAg
ICApCiAgICAgICAgICAgIHdpdGggb3Blbih0b19ieXRlcyhpbl9wYXRoKSwgInJi
IikgYXMgZjoKICAgICAgICAgICAgICAgIHNlbGYuX3MzX2NsaWVudC51cGxvYWRf
ZmlsZW9iaihmLCBzZWxmLmdldF9vcHRpb24oImJ1Y2tldCIpLCBwYXRoKQogICAg
ICAgICAgICByZXN1bHQgPSBzZWxmLmV4ZWNfY29tbWFuZChjb21tYW5kLCBpbl9k
YXRhPU5vbmUsIHN1ZG9hYmxlPUZhbHNlKQoKICAgICAgICBzZWxmLl9zM19jbGll
bnQuZGVsZXRlX29iamVjdChCdWNrZXQ9c2VsZi5nZXRfb3B0aW9uKCJidWNrZXQi
KSwgS2V5PXBhdGgpCgogICAgICAgIChyZXR1cm5jb2RlLCBzdGRvdXQsIHN0ZGVy
cikgPSByZXN1bHQKICAgICAgICBpZiByZXR1cm5jb2RlID09IDA6CiAgICAgICAg
ICAgIHJldHVybiAocmV0dXJuY29kZSwgc3Rkb3V0LCBzdGRlcnIpCiAgICAgICAg
ZWxzZToKICAgICAgICAgICAgcmFpc2UgQW5zaWJsZUVycm9yKAogICAgICAgICAg
ICAgICAgImZhaWxlZCB0byB0cmFuc2ZlciBmaWxlIHRvICVzICVzOlxuJXNcbiVz
IgogICAgICAgICAgICAgICAgJSAoCiAgICAgICAgICAgICAgICAgICAgdG9fbmF0
aXZlKGluX3BhdGgpLAogICAgICAgICAgICAgICAgICAgIHRvX25hdGl2ZShvdXRf
cGF0aCksCiAgICAgICAgICAgICAgICAgICAgdG9fbmF0aXZlKHN0ZG91dCksCiAg
ICAgICAgICAgICAgICAgICAgdG9fbmF0aXZlKHN0ZGVyciksCiAgICAgICAgICAg
ICAgICApCiAgICAgICAgICAgICkKCiAgICBkZWYgcHV0X2ZpbGUoc2VsZiwgaW5f
cGF0aCwgb3V0X3BhdGgpOgogICAgICAgIHN1cGVyKENvbm5lY3Rpb24sIHNlbGYp
LnB1dF9maWxlKGluX3BhdGgsIG91dF9wYXRoKQogICAgICAgIGRpc3BsYXkudnZ2
KHUiUFVUIHswfSBUTyB7MX0iLmZvcm1hdChpbl9wYXRoLCBvdXRfcGF0aCksIGhv
c3Q9c2VsZi5ob3N0KQogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyh0b19i
eXRlcyhpbl9wYXRoKSk6CiAgICAgICAgICAgIHJhaXNlIEFuc2libGVGaWxlTm90
Rm91bmQoCiAgICAgICAgICAgICAgICAiZmlsZSBvciBtb2R1bGUgZG9lcyBub3Qg
ZXhpc3Q6IHswfSIuZm9ybWF0KHRvX25hdGl2ZShpbl9wYXRoKSkKICAgICAgICAg
ICAgKQogICAgICAgIHJldHVybiBzZWxmLl9maWxlX3RyYW5zcG9ydF9jb21tYW5k
KGluX3BhdGgsIG91dF9wYXRoLCAicHV0IikKCiAgICBkZWYgZmV0Y2hfZmlsZShz
ZWxmLCBpbl9wYXRoLCBvdXRfcGF0aCk6CiAgICAgICAgc3VwZXIoQ29ubmVjdGlv
biwgc2VsZikuZmV0Y2hfZmlsZShpbl9wYXRoLCBvdXRfcGF0aCkKICAgICAgICBk
aXNwbGF5LnZ2dih1IkZFVENIIHswfSBUTyB7MX0iLmZvcm1hdChpbl9wYXRoLCBv
dXRfcGF0aCksIGhvc3Q9c2VsZi5ob3N0KQogICAgICAgIHJldHVybiBzZWxmLl9m
aWxlX3RyYW5zcG9ydF9jb21tYW5kKGluX3BhdGgsIG91dF9wYXRoLCAiZ2V0IikK
CiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuX3Nlc3Np
b25faWQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBkaXNwbGF5LnZ2dih1
IkNMT1NFIFNTTTogezB9Ii5mb3JtYXQoc2VsZi5pbnN0YW5jZV9pZCksIGhvc3Q9
c2VsZi5ob3N0KQoKICAgICAgICBpZiBzZWxmLl90ZXJtaW5hdGU6CiAgICAgICAg
ICAgIHNlbGYuX3Byb2Nlc3MudGVybWluYXRlKCkKICAgICAgICBlbHNlOgogICAg
ICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLl9wcm9jZXNzLmNvbW11
bmljYXRlKGIiXG5leGl0XG4iKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9u
IGFzIGU6ICAjIE5vdCBzdXJlIHdoeSB0aGlzIGZhaWxzIHNvbWV0aW1lcwogICAg
ICAgICAgICAgICAgZGlzcGxheS52dnYodSJFUlJPUiBDTE9TSU5HIFNTTTogezB9
Ii5mb3JtYXQoZSksIGhvc3Q9c2VsZi5ob3N0KQogICAgICAgICAgICAgICAgc2Vs
Zi5fcHJvY2Vzcy50ZXJtaW5hdGUoKQoKICAgICAgICBkaXNwbGF5LnZ2dnYodSJU
RVJNSU5BVEUgU1NNOiB7MH0iLmZvcm1hdChzZWxmLl9zZXNzaW9uX2lkKSwgaG9z
dD1zZWxmLmhvc3QpCiAgICAgICAgc2VsZi5fc3NtX2NsaWVudC50ZXJtaW5hdGVf
c2Vzc2lvbihTZXNzaW9uSWQ9c2VsZi5fc2Vzc2lvbl9pZCkKICAgICAgICBzZWxm
Ll9zZXNzaW9uX2lkID0gTm9uZQo="""
).decode("utf-8")
